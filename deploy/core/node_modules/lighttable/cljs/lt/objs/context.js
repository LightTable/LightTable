// Compiled by ClojureScript 1.10.844 {}
goog.provide('lt.objs.context');
goog.require('cljs.core');
goog.require('lt.object');
lt.objs.context.contexts = cljs.core.atom.call(null,cljs.core.PersistentHashSet.EMPTY);
lt.objs.context.groups = cljs.core.atom.call(null,cljs.core.PersistentArrayMap.EMPTY);
lt.objs.context.ctx__GT_obj = cljs.core.atom.call(null,cljs.core.PersistentArrayMap.EMPTY);
lt.objs.context.ctx__GT_group = cljs.core.atom.call(null,cljs.core.PersistentArrayMap.EMPTY);
lt.objs.context.group__GT_ctxs = cljs.core.atom.call(null,cljs.core.PersistentArrayMap.EMPTY);
lt.objs.context.append_group = (function lt$objs$context$append_group(group,name){
return cljs.core.swap_BANG_.call(null,lt.objs.context.groups,(function (all){
if(cljs.core.truth_(all.call(null,group))){
return cljs.core.update_in.call(null,all,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [group], null),cljs.core.conj,name);
} else {
return cljs.core.assoc.call(null,all,group,cljs.core.PersistentHashSet.createAsIfByAssoc([name]));
}
}));
});
lt.objs.context.in_QMARK_ = (function lt$objs$context$in_QMARK_(k){
return cljs.core.deref.call(null,lt.objs.context.contexts).call(null,k);
});
lt.objs.context.out_BANG_ = (function lt$objs$context$out_BANG_(var_args){
var G__6571 = arguments.length;
switch (G__6571) {
case 1:
return lt.objs.context.out_BANG_.cljs$core$IFn$_invoke$arity$1((arguments[(0)]));

break;
case 2:
return lt.objs.context.out_BANG_.cljs$core$IFn$_invoke$arity$2((arguments[(0)]),(arguments[(1)]));

break;
default:
throw (new Error(["Invalid arity: ",cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join('')));

}
});

(lt.objs.context.out_BANG_.cljs$core$IFn$_invoke$arity$1 = (function (ctxs){
var ctxs__$1 = ((cljs.core.coll_QMARK_.call(null,ctxs))?ctxs:new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [ctxs], null));
cljs.core.swap_BANG_.call(null,lt.objs.context.contexts,(function (p1__6568_SHARP_){
return cljs.core.apply.call(null,cljs.core.disj,p1__6568_SHARP_,ctxs__$1);
}));

cljs.core.swap_BANG_.call(null,lt.objs.context.ctx__GT_obj,(function (p1__6569_SHARP_){
return cljs.core.apply.call(null,cljs.core.dissoc,p1__6569_SHARP_,ctxs__$1);
}));

return lt.object.raise.call(null,lt.objs.context.ctx_obj,new cljs.core.Keyword(null,"log!","log!",303701345));
}));

(lt.objs.context.out_BANG_.cljs$core$IFn$_invoke$arity$2 = (function (ctxs,_){
return lt.objs.context.out_BANG_.call(null,ctxs);
}));

(lt.objs.context.out_BANG_.cljs$lang$maxFixedArity = 2);

lt.objs.context.in_BANG_ = (function lt$objs$context$in_BANG_(var_args){
var args__4777__auto__ = [];
var len__4771__auto___6585 = arguments.length;
var i__4772__auto___6586 = (0);
while(true){
if((i__4772__auto___6586 < len__4771__auto___6585)){
args__4777__auto__.push((arguments[i__4772__auto___6586]));

var G__6587 = (i__4772__auto___6586 + (1));
i__4772__auto___6586 = G__6587;
continue;
} else {
}
break;
}

var argseq__4778__auto__ = ((((1) < args__4777__auto__.length))?(new cljs.core.IndexedSeq(args__4777__auto__.slice((1)),(0),null)):null);
return lt.objs.context.in_BANG_.cljs$core$IFn$_invoke$arity$variadic((arguments[(0)]),argseq__4778__auto__);
});

(lt.objs.context.in_BANG_.cljs$core$IFn$_invoke$arity$variadic = (function (ctxs,p__6577){
var vec__6578 = p__6577;
var obj = cljs.core.nth.call(null,vec__6578,(0),null);
var ctxs__$1 = ((cljs.core.coll_QMARK_.call(null,ctxs))?ctxs:new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [ctxs], null));
cljs.core.swap_BANG_.call(null,lt.objs.context.contexts,(function (p1__6573_SHARP_){
return cljs.core.apply.call(null,cljs.core.conj,p1__6573_SHARP_,ctxs__$1);
}));

cljs.core.swap_BANG_.call(null,lt.objs.context.ctx__GT_obj,(function (p1__6574_SHARP_){
return cljs.core.merge.call(null,p1__6574_SHARP_,cljs.core.zipmap.call(null,ctxs__$1,cljs.core.repeat.call(null,obj)));
}));

lt.object.raise.call(null,lt.objs.context.ctx_obj,new cljs.core.Keyword(null,"log!","log!",303701345));

var seq__6581 = cljs.core.seq.call(null,ctxs__$1);
var chunk__6582 = null;
var count__6583 = (0);
var i__6584 = (0);
while(true){
if((i__6584 < count__6583)){
var c = cljs.core._nth.call(null,chunk__6582,i__6584);
var temp__5753__auto___6588 = cljs.core.deref.call(null,lt.objs.context.group__GT_ctxs).call(null,cljs.core.deref.call(null,lt.objs.context.ctx__GT_group).call(null,c));
if(cljs.core.truth_(temp__5753__auto___6588)){
var group_6589 = temp__5753__auto___6588;
lt.objs.context.out_BANG_.call(null,group_6589);
} else {
}


var G__6590 = seq__6581;
var G__6591 = chunk__6582;
var G__6592 = count__6583;
var G__6593 = (i__6584 + (1));
seq__6581 = G__6590;
chunk__6582 = G__6591;
count__6583 = G__6592;
i__6584 = G__6593;
continue;
} else {
var temp__5753__auto__ = cljs.core.seq.call(null,seq__6581);
if(temp__5753__auto__){
var seq__6581__$1 = temp__5753__auto__;
if(cljs.core.chunked_seq_QMARK_.call(null,seq__6581__$1)){
var c__4591__auto__ = cljs.core.chunk_first.call(null,seq__6581__$1);
var G__6594 = cljs.core.chunk_rest.call(null,seq__6581__$1);
var G__6595 = c__4591__auto__;
var G__6596 = cljs.core.count.call(null,c__4591__auto__);
var G__6597 = (0);
seq__6581 = G__6594;
chunk__6582 = G__6595;
count__6583 = G__6596;
i__6584 = G__6597;
continue;
} else {
var c = cljs.core.first.call(null,seq__6581__$1);
var temp__5753__auto___6598__$1 = cljs.core.deref.call(null,lt.objs.context.group__GT_ctxs).call(null,cljs.core.deref.call(null,lt.objs.context.ctx__GT_group).call(null,c));
if(cljs.core.truth_(temp__5753__auto___6598__$1)){
var group_6599 = temp__5753__auto___6598__$1;
lt.objs.context.out_BANG_.call(null,group_6599);
} else {
}


var G__6600 = cljs.core.next.call(null,seq__6581__$1);
var G__6601 = null;
var G__6602 = (0);
var G__6603 = (0);
seq__6581 = G__6600;
chunk__6582 = G__6601;
count__6583 = G__6602;
i__6584 = G__6603;
continue;
}
} else {
return null;
}
}
break;
}
}));

(lt.objs.context.in_BANG_.cljs$lang$maxFixedArity = (1));

/** @this {Function} */
(lt.objs.context.in_BANG_.cljs$lang$applyTo = (function (seq6575){
var G__6576 = cljs.core.first.call(null,seq6575);
var seq6575__$1 = cljs.core.next.call(null,seq6575);
var self__4758__auto__ = this;
return self__4758__auto__.cljs$core$IFn$_invoke$arity$variadic(G__6576,seq6575__$1);
}));

lt.objs.context.toggle_BANG_ = (function lt$objs$context$toggle_BANG_(var_args){
var args__4777__auto__ = [];
var len__4771__auto___6614 = arguments.length;
var i__4772__auto___6615 = (0);
while(true){
if((i__4772__auto___6615 < len__4771__auto___6614)){
args__4777__auto__.push((arguments[i__4772__auto___6615]));

var G__6616 = (i__4772__auto___6615 + (1));
i__4772__auto___6615 = G__6616;
continue;
} else {
}
break;
}

var argseq__4778__auto__ = ((((1) < args__4777__auto__.length))?(new cljs.core.IndexedSeq(args__4777__auto__.slice((1)),(0),null)):null);
return lt.objs.context.toggle_BANG_.cljs$core$IFn$_invoke$arity$variadic((arguments[(0)]),argseq__4778__auto__);
});

(lt.objs.context.toggle_BANG_.cljs$core$IFn$_invoke$arity$variadic = (function (ctxs,p__6606){
var vec__6607 = p__6606;
var obj = cljs.core.nth.call(null,vec__6607,(0),null);
var seq__6610 = cljs.core.seq.call(null,ctxs);
var chunk__6611 = null;
var count__6612 = (0);
var i__6613 = (0);
while(true){
if((i__6613 < count__6612)){
var c = cljs.core._nth.call(null,chunk__6611,i__6613);
if(cljs.core.truth_(lt.objs.context.in_QMARK_.call(null,c))){
lt.objs.context.out_BANG_.call(null,c);
} else {
lt.objs.context.in_BANG_.call(null,c,obj);
}


var G__6617 = seq__6610;
var G__6618 = chunk__6611;
var G__6619 = count__6612;
var G__6620 = (i__6613 + (1));
seq__6610 = G__6617;
chunk__6611 = G__6618;
count__6612 = G__6619;
i__6613 = G__6620;
continue;
} else {
var temp__5753__auto__ = cljs.core.seq.call(null,seq__6610);
if(temp__5753__auto__){
var seq__6610__$1 = temp__5753__auto__;
if(cljs.core.chunked_seq_QMARK_.call(null,seq__6610__$1)){
var c__4591__auto__ = cljs.core.chunk_first.call(null,seq__6610__$1);
var G__6621 = cljs.core.chunk_rest.call(null,seq__6610__$1);
var G__6622 = c__4591__auto__;
var G__6623 = cljs.core.count.call(null,c__4591__auto__);
var G__6624 = (0);
seq__6610 = G__6621;
chunk__6611 = G__6622;
count__6612 = G__6623;
i__6613 = G__6624;
continue;
} else {
var c = cljs.core.first.call(null,seq__6610__$1);
if(cljs.core.truth_(lt.objs.context.in_QMARK_.call(null,c))){
lt.objs.context.out_BANG_.call(null,c);
} else {
lt.objs.context.in_BANG_.call(null,c,obj);
}


var G__6625 = cljs.core.next.call(null,seq__6610__$1);
var G__6626 = null;
var G__6627 = (0);
var G__6628 = (0);
seq__6610 = G__6625;
chunk__6611 = G__6626;
count__6612 = G__6627;
i__6613 = G__6628;
continue;
}
} else {
return null;
}
}
break;
}
}));

(lt.objs.context.toggle_BANG_.cljs$lang$maxFixedArity = (1));

/** @this {Function} */
(lt.objs.context.toggle_BANG_.cljs$lang$applyTo = (function (seq6604){
var G__6605 = cljs.core.first.call(null,seq6604);
var seq6604__$1 = cljs.core.next.call(null,seq6604);
var self__4758__auto__ = this;
return self__4758__auto__.cljs$core$IFn$_invoke$arity$variadic(G__6605,seq6604__$1);
}));

lt.objs.context.current = (function lt$objs$context$current(){
return cljs.core.deref.call(null,lt.objs.context.contexts);
});
lt.objs.context.group_BANG_ = (function lt$objs$context$group_BANG_(ctx,group){
cljs.core.swap_BANG_.call(null,lt.objs.context.ctx__GT_group,cljs.core.assoc,ctx,group);

return cljs.core.swap_BANG_.call(null,lt.objs.context.group__GT_ctxs,cljs.core.update_in,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [group], null),cljs.core.conj,ctx);
});
lt.objs.context.__GT_obj = (function lt$objs$context$__GT_obj(ctx){
return cljs.core.deref.call(null,lt.objs.context.ctx__GT_obj).call(null,ctx);
});
lt.objs.context.enqueue = (function lt$objs$context$enqueue(coll,buffer,size){
if(cljs.core._EQ_.call(null,size,cljs.core.count.call(null,buffer))){
return cljs.core.conj.call(null,cljs.core.pop.call(null,buffer),coll);
} else {
return cljs.core.conj.call(null,buffer,coll);
}
});
/**
 * 
 */
lt.objs.context.__BEH__log = (function lt$objs$context$__BEH__log(this$){
var size = new cljs.core.Keyword(null,"buffer-size","buffer-size",1047120420).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,this$));
var ctx = cljs.core.deref.call(null,lt.objs.context.contexts);
return lt.object.update_BANG_.call(null,this$,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"history","history",-247395220)], null),(function (p1__6629_SHARP_){
return lt.objs.context.enqueue.call(null,ctx,p1__6629_SHARP_,size);
}));
});

lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.context","log","lt.objs.context/log",-900197159),new cljs.core.Keyword(null,"debounce","debounce",-871550296),(16),new cljs.core.Keyword(null,"triggers","triggers",-1443678770),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"log!","log!",303701345),null], null), null),new cljs.core.Keyword(null,"reaction","reaction",490869788),lt.objs.context.__BEH__log);
lt.object.object_STAR_.call(null,new cljs.core.Keyword("lt.objs.context","context","lt.objs.context/context",2030425266),new cljs.core.Keyword(null,"tags","tags",1771418977),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"context","context",-830191113),null], null), null),new cljs.core.Keyword(null,"history","history",-247395220),cljs.core.PersistentQueue.EMPTY,new cljs.core.Keyword(null,"buffer-size","buffer-size",1047120420),(8),new cljs.core.Keyword(null,"init","init",-1875481434),(function (this$){
return null;
}));
lt.objs.context.ctx_obj = lt.object.create.call(null,new cljs.core.Keyword("lt.objs.context","context","lt.objs.context/context",2030425266));
